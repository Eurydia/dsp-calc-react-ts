import{r as h,j as e}from"./react-c7x3VyAv.js";import{c as Ce}from"./react-dom-nwdlp_2f.js";import{c as be,T as xe,M as oe,I as ce,u as Me,a as Oe,S as M,P as F,G as N,D as Re,b as y,d as w,e as E,R as A,f as le,g as ae,h as de,i as T,j as b,k as ue,l as G,A as pe,L as $,m as f,n as g,F as W,o as S,p as Pe,C as Ie,q as z,U as Ne,B as X,r as Te,s as Fe,t as ve,v as Le,w as ke}from"./@mui-ZA6XCrvw.js";import{f as Y,F as we}from"./facility.mts-B4jVh-jX.js";import{r as q,a as H}from"./recipes-wAzjHo70.js";import{p as Q,P as me,a as je}from"./proliferator.mts-9Q72QBkP.js";import{s as Ee}from"./sorter.mts-RHRkJXms.js";/* empty css                    */import"./hoist-non-react-statics-bbVbV8Pa.js";import"./scheduler-jfnXNWZW.js";import"./prop-types-pmxPFTpu.js";import"./react-is-D0-Nh74l.js";import"./@babel-R4VyUtW_.js";import"./@emotion-KQWZ46Z_.js";import"./stylis-UTZzoVRx.js";import"./clsx-Zbgk8kpT.js";import"./react-transition-group-xc2LJcsj.js";import"./@popperjs-v-la0Vhf.js";import"./ingredient.mts-_hV6avPQ.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const p of a.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&l(p)}).observe(document,{childList:!0,subtree:!0});function o(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(n){if(n.ep)return;n.ep=!0;const a=o(n);fetch(n.href,a)}})();const Ae=be({components:{MuiTypography:{styleOverrides:{root:{userSelect:"none"}}}},palette:{mode:"dark"}}),Z=c=>{const{sortOptions:s,label:o,value:l,onValueChange:n,options:a,disabledOptions:p}=c,C=h.useMemo(()=>s?a.sort():a,[a,s]),d=h.useMemo(()=>s?p.sort():p,[p,s]);return e.jsxs(xe,{select:!0,fullWidth:!0,label:o,value:l,onChange:m=>n(m.target.value),children:[C.filter(m=>!d.includes(m)).map(m=>e.jsx(oe,{value:m,children:m},m)),d.map(m=>e.jsx(oe,{disabled:!0,value:m,children:m},m))]})},B=c=>{const{disabled:s,maxLength:o,prefix:l,suffix:n,label:a,value:p,onChange:C}=c,d=m=>{const i=m.target.value.slice(0,o).normalize();C(i)};return e.jsx(xe,{fullWidth:!0,disabled:s,label:a,value:p,onChange:d,InputProps:{startAdornment:e.jsx(ce,{position:"start",children:l}),endAdornment:e.jsx(ce,{position:"end",children:n})}})},L=(c,s,o)=>{const l=Number.parseInt(c);return Number.isNaN(l)?s:l>o?o:l<s?s:l},k=c=>c.reduce((s,o)=>s+o,0),D=c=>Number.parseFloat(c.toPrecision(9)).toPrecision(),K=(c,s,o)=>{const l=localStorage.getItem(c);if(l===null)return o;try{return s(JSON.parse(l))}catch{return o}},$e=(c,s,o,l,n,a)=>{const p=Object.fromEntries(Object.entries(l).map(([i,R])=>{let u=Number.parseInt(R);return(Number.isNaN(u)||u===0)&&(u=360),[i,u]})),C=60/c*s,d=Math.min(...Object.entries(n).map(([i,R])=>{const u=R*C;return p[i]/u})),m=Math.min(...Object.entries(a).map(([i,R])=>{const u=R*C*o;return p[i]/u}));return Math.min(d,m)},We=(c,s,o,l,n)=>{const a=Object.fromEntries(Object.entries(n).map(([d,m])=>{let i=Number.parseInt(m);return Number.isNaN(i)&&(i=0),[d,i]}));if(Object.values(a).every(d=>d===0))return 0;const p=60/c*s;return Math.max(...Object.entries(l).map(([d,m])=>{const i=m*p*o;return a[d]/i}))},he=c=>{const s=Object.fromEntries(Object.entries(c).map(([l,n])=>{let a=Number.parseInt(n);return Number.isNaN(a)&&(a=0),[l,a]}));return k(Object.entries(s).map(([l,n])=>Ee(l).idleConsumptionMW*n))},ze=(c,s)=>{const o=he(s);return c+o},Be=(c,s,o)=>{const l=he(o);return c*s+l},De=(c,s,o,l,n,a,p)=>{const C=60/c*s,d=Object.fromEntries(Object.entries(l).map(([i,R])=>[i,R*C])),m=Number.parseInt(p);return!Number.isNaN(m)&&m>0&&(d[`${a} (on materials)`]=k(Object.values(l).map(i=>C*i))/m,d[`${a} (on products)`]=k(Object.values(n).map(i=>C*i*o))/m),d},Je=(c,s,o,l)=>{const n=60/c*s;return Object.fromEntries(Object.entries(l).map(([p,C])=>[p,C*n*o]))},Ue=c=>{const{slotSide:s,children:o,slotMain:l}=c;return e.jsxs(M,{padding:2,spacing:2,children:[e.jsx(F,{sx:{padding:2},children:s}),l,h.Children.toArray(o).map((n,a)=>e.jsx(F,{sx:{padding:2},children:n},`main-col-item-${a}`))]})},Ve=c=>{const{children:s,slotMain:o,slotSide:l}=c;return e.jsxs(N,{container:!0,height:"100vh",children:[e.jsx(N,{item:!0,md:8,padding:2,height:"100%",overflow:"auto",sx:{scrollbarWidth:"thin"},children:e.jsxs(N,{container:!0,spacing:2,children:[e.jsx(N,{item:!0,md:12,children:o}),[0,1].map(n=>e.jsx(N,{item:!0,md:6,children:e.jsx(M,{spacing:2,children:h.Children.toArray(s).filter((a,p)=>p%2===n).map((a,p)=>e.jsx(F,{sx:{padding:2},children:a},`main-col-${n}-item-${p}`))})},`main-col-${n}`))]})}),e.jsx(N,{item:!0,md:4,height:"100%",overflow:"auto",children:e.jsx(F,{sx:{padding:2},children:l})})]})},_e=c=>{const{slotSide:s,slotMain:o,children:l}=c,n=Me();return Oe(n.breakpoints.down("sm"))?e.jsx(Ue,{children:l,slotMain:o,slotSide:s}):e.jsx(Ve,{children:l,slotMain:o,slotSide:s})},Ge=(c,s)=>{const[o,l]=h.useState(()=>{const n=localStorage.getItem(s);if(n===null)return c;try{return JSON.parse(n)}catch{return c}});return h.useEffect(()=>{localStorage.setItem(s,JSON.stringify(o))},[s,o]),{content:o,setContent:l}},ee=(c,s)=>{const[o,l]=h.useState(()=>{const n=localStorage.getItem(s);if(n===null)return c;try{return JSON.parse(n)}catch{return c}});return h.useEffect(()=>{localStorage.setItem(s,JSON.stringify(o))},[o,s]),{content:o,setContent:l}},Xe=()=>{const{content:c,setContent:s}=ee({"Sorter Mk.I":"0","Sorter Mk.II":"0","Sorter Mk.III":"0","Pile Sorter":"0"},"sorters"),{content:o,setContent:l}=ee({},"flowrates"),{content:n,setContent:a}=ee({},"desiredProduction"),{content:p,setContent:C}=Ge("0","sprayCount"),[d,m]=h.useState(()=>K("activeFacility",Y,Y("Arc Smelter"))),[i,R]=h.useState(()=>K("activeRecipe",q,q("Copper Ingot"))),[u,ye]=h.useState(()=>K("activeProlif",Q,Q("None")));h.useEffect(()=>{a(t=>{const r={};for(const j of Object.keys(i.productRecord))r[j]=t[j]??"0";return r}),l(()=>{const t={};for(const r of Object.keys(i.materialRecord))t[r]="360";for(const r of Object.keys(i.productRecord))t[r]="360";return t})},[i,a,l]);const fe=t=>{const r=Y(t);if(m(r),localStorage.setItem("activeFacility",JSON.stringify(r.label)),i.recipeType===r.recipeType)return;let j="Uh oh";const x=Object.values(H).filter(({recipeType:I})=>I===r.recipeType).map(({label:I})=>I);x.length>0&&(j=x[0]),te(j)},te=t=>{const r=q(t);r.speedupOnly&&u.mode===je.EXTRA_PRODUCTS&&re("None"),R(r),localStorage.setItem("activeRecipe",JSON.stringify(r.label))},re=t=>{const r=Q(t);C(r.sprayCount.toString()),ye(r),localStorage.setItem("activeProlif",JSON.stringify(r.label))},ne=(t,r)=>{a(j=>{const x={...j};return r===""?(x[t]="",x):(x[t]=L(r,0,1e7).toString(),x)})},se=(t,r)=>{l(j=>{const x={...j};if(r==="")return x[t]="",x;const I=d.connectionCount*7200,v=k(Object.entries(j).filter(([_])=>_!==t).map(([,_])=>L(_,360,I)));return x[t]=L(r,0,I-v).toString(),x})},ie=(t,r)=>{s(j=>{const x={...j};if(r==="")return x[t]="",x;const I=k(Object.entries(j).filter(([v])=>v!==t).map(([,v])=>L(v,0,d.connectionCount)));return x[t]=L(r,0,d.connectionCount-I).toString(),x})},ge=h.useMemo(()=>u.sprayCount===12?"Proliferator Mk.I":u.sprayCount===24?"Proliferator Mk.II":u.sprayCount===60?"Proliferator Mk.III":"None",[u]),P=h.useMemo(()=>We(i.cycleTimeSecond,d.cycleMultiplier*u.cycleMultiplier,u.productMultiplier,i.productRecord,n),[i.cycleTimeSecond,i.productRecord,d.cycleMultiplier,u.cycleMultiplier,u.productMultiplier,n]),O=h.useMemo(()=>$e(i.cycleTimeSecond,d.cycleMultiplier*u.cycleMultiplier,u.productMultiplier,o,i.materialRecord,i.productRecord),[i.cycleTimeSecond,i.materialRecord,i.productRecord,d.cycleMultiplier,u.cycleMultiplier,u.productMultiplier,o]),J=h.useMemo(()=>O<=0?0:Math.floor(P/O),[O,P]),Se=h.useMemo(()=>{const t=J*O;return P-t},[J,O,P]),U=h.useMemo(()=>Be(d.workConsumptionMW,u.workConsumptionMultiplier,c),[d.workConsumptionMW,u.workConsumptionMultiplier,c]),V=h.useMemo(()=>ze(d.idleConsumptionMW,c),[d.idleConsumptionMW,c]);return e.jsxs(_e,{slotSide:e.jsxs(M,{spacing:4,divider:e.jsx(Re,{flexItem:!0,variant:"fullWidth"}),children:[e.jsxs(M,{spacing:2,children:[e.jsx(y,{children:"Manufacturing"}),e.jsx(Z,{sortOptions:!0,label:"Facility",value:d.label,onValueChange:fe,options:Object.keys(we),disabledOptions:[]}),e.jsx(Z,{sortOptions:!0,label:"Recipe",value:i.label,onValueChange:te,options:Object.keys(H),disabledOptions:Object.values(H).filter(t=>t.recipeType!==d.recipeType).map(t=>t.label)})]}),e.jsxs(M,{spacing:2,children:[e.jsx(y,{children:"Production target"}),Object.entries(n).map(([t,r])=>e.jsxs(M,{spacing:2,direction:"row",alignItems:"center",justifyContent:"left",children:[e.jsx(B,{label:t,maxLength:8,suffix:"/min",value:r,onChange:j=>ne(t,j)}),e.jsx(w,{disabled:r==="0",onClick:()=>ne(t,"0"),children:e.jsx(E,{title:"Reset",children:e.jsx(A,{})})})]},t))]}),e.jsxs(M,{spacing:2,children:[e.jsx(y,{children:"Proliferation"}),e.jsx(Z,{label:"Proliferator",value:u.label,onValueChange:re,options:Object.keys(me),disabledOptions:Object.values(me).filter(t=>i.speedupOnly&&t.mode===je.EXTRA_PRODUCTS).map(t=>t.label)}),e.jsxs(M,{spacing:2,direction:"row",alignItems:"center",justifyContent:"left",children:[e.jsx(B,{disabled:u.sprayCount<=0,maxLength:9,suffix:"sprays",label:"Uses",value:p,onChange:C}),e.jsx(w,{disabled:u.sprayCount<=0||u.sprayCount.toString()===p,onClick:()=>C(u.sprayCount.toString()),children:e.jsx(E,{title:"Reset",children:e.jsx(A,{})})})]})]}),e.jsxs(M,{spacing:2,children:[e.jsx(y,{children:"Transport capacity"}),Object.entries(o).map(([t,r])=>e.jsxs(M,{spacing:2,direction:"row",alignItems:"center",justifyContent:"left",children:[e.jsx(B,{label:t,maxLength:8,suffix:"/min",value:r,onChange:j=>se(t,j)}),e.jsx(w,{disabled:r==="360",onClick:()=>se(t,"360"),children:e.jsx(E,{title:"Reset",children:e.jsx(A,{})})})]},t))]}),e.jsxs(M,{spacing:2,children:[e.jsx(y,{children:"Sorter connections"}),Object.entries(c).map(([t,r])=>e.jsxs(M,{spacing:2,direction:"row",alignItems:"center",justifyContent:"left",children:[e.jsx(B,{label:t,maxLength:6,suffix:`/${d.connectionCount}`,value:r,onChange:j=>ie(t,j)}),e.jsx(w,{disabled:r==="0",onClick:()=>ie(t,"0"),children:e.jsx(E,{title:"Reset",children:e.jsx(A,{})})})]},t))]})]}),slotMain:e.jsxs(M,{spacing:2,children:[e.jsx(F,{sx:{padding:2},children:e.jsx(le,{children:e.jsxs(ae,{children:[e.jsx(de,{children:e.jsxs(T,{children:[e.jsx(b,{colSpan:3,children:e.jsx(y,{color:"primary",children:"Item (per minute)"})}),e.jsx(b,{colSpan:1,align:"right",children:e.jsx(y,{color:"primary",children:"Total"})}),e.jsx(b,{colSpan:1,align:"right",children:e.jsx(y,{color:"primary",children:"Per Array"})}),e.jsx(b,{colSpan:1,align:"right",children:e.jsx(y,{color:"primary",children:"Per Facility"})})]})}),e.jsxs(ue,{children:[Object.entries(De(i.cycleTimeSecond,u.cycleMultiplier*d.cycleMultiplier,u.productMultiplier,i.materialRecord,i.productRecord,ge,p)).map(([t,r])=>e.jsxs(T,{children:[e.jsx(b,{colSpan:3,children:t}),[r*P,r*O,r].map((j,x)=>e.jsx(b,{colSpan:1,children:e.jsxs(y,{display:"flex",alignItems:"center",justifyContent:"flex-end",fontSize:"inherit",children:[e.jsx(G,{fontSize:"inherit"}),D(j)]})},`demand-${x}`))]},t)),Object.entries(Je(i.cycleTimeSecond,u.cycleMultiplier*d.cycleMultiplier,u.productMultiplier,i.productRecord)).map(([t,r])=>e.jsxs(T,{children:[e.jsx(b,{colSpan:3,children:t}),[r*P,r*O,r].map((j,x)=>e.jsx(b,{colSpan:1,children:e.jsxs(y,{display:"flex",alignItems:"center",justifyContent:"flex-end",fontSize:"inherit",children:[e.jsx(pe,{fontSize:"inherit"}),D(j)]})},`supply-${x}`))]},t))]})]})})}),e.jsx(F,{sx:{padding:2},children:e.jsx(le,{children:e.jsxs(ae,{children:[e.jsx(de,{children:e.jsxs(T,{children:[e.jsx(b,{colSpan:3,children:e.jsx(y,{color:"primary",children:"Power consumption (MW)"})}),e.jsx(b,{colSpan:1,align:"right",children:e.jsx(y,{color:"primary",children:"Total"})}),e.jsx(b,{colSpan:1,align:"right",children:e.jsx(y,{color:"primary",children:"Per array"})}),e.jsx(b,{colSpan:1,align:"right",children:e.jsx(y,{color:"primary",children:"Per facility"})})]})}),e.jsxs(ue,{children:[e.jsxs(T,{children:[e.jsx(b,{colSpan:3,children:"Work"}),[U*P,U*O,U].map((t,r)=>e.jsx(b,{colSpan:1,children:e.jsxs(y,{display:"flex",alignItems:"center",justifyContent:"flex-end",fontSize:"inherit",children:[e.jsx(G,{fontSize:"inherit"}),D(t)]})},`supply-${r}`))]}),e.jsxs(T,{children:[e.jsx(b,{colSpan:3,children:"Idle"}),[V*P,V*O,V].map((t,r)=>e.jsx(b,{colSpan:1,children:e.jsxs(y,{display:"flex",alignItems:"center",justifyContent:"flex-end",fontSize:"inherit",children:[e.jsx(G,{fontSize:"inherit"}),D(t)]})},`supply-${r}`))]})]})]})})})]}),children:[e.jsxs($,{subheader:"Layout",dense:!0,children:[e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(W,{})}),e.jsx(S,{primary:O,secondary:"Facilities per array"})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(W,{})}),e.jsx(S,{primary:J,secondary:"Arrays"})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(W,{})}),e.jsx(S,{primary:P,secondary:"Total facilities"})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(W,{})}),e.jsx(S,{primary:Se,secondary:"Leftover facilities"})]})]}),e.jsxs($,{subheader:"Facility information",dense:!0,children:[e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(Pe,{})}),e.jsx(S,{primary:d.label,secondary:"Name"})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(Ie,{})}),e.jsx(S,{primary:d.recipeType,secondary:"Category"})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(z,{})}),e.jsx(S,{primary:`${(d.cycleMultiplier*100).toPrecision()}%`,secondary:"Cycle speed"})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(Ne,{})}),e.jsx(S,{primary:d.connectionCount,secondary:"Sorter connections"})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(X,{})}),e.jsx(S,{primary:`${d.workConsumptionMW.toPrecision()} MW`,secondary:"Work comsumption"})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(X,{})}),e.jsx(S,{primary:`${d.idleConsumptionMW.toPrecision()} MW`,secondary:"Idle comsumption"})]})]}),e.jsxs($,{subheader:"Recipe infomation",dense:!0,children:[e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(z,{})}),e.jsx(S,{primary:`${i.cycleTimeSecond} s`,secondary:"Cycle time"})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(Te,{})}),e.jsx(S,{primary:i.speedupOnly?"No":"Yes",secondary:"Extra products bonus"})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(Fe,{})}),e.jsx(S,{primary:Object.entries(i.materialRecord).map(([t,r])=>e.jsx(y,{fontSize:"inherit",children:`${r} ${t}`},t)),secondary:"Materials"})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(pe,{})}),e.jsx(S,{primary:Object.entries(i.productRecord).map(([t,r])=>e.jsx(y,{fontSize:"inherit",children:`${r} ${t}`},t)),secondary:"Products"})]})]}),e.jsxs($,{dense:!0,subheader:"Proliferator effects",children:[e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(X,{})}),e.jsx(S,{primary:`${((u.workConsumptionMultiplier-1)*100).toPrecision()}%`,secondary:"Additional work consumption"})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(z,{})}),e.jsx(S,{primary:`${((u.cycleMultiplier-1)*100).toPrecision()}%`,secondary:"Bonus cycle speed"})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(z,{})}),e.jsx(S,{primary:`${((u.productMultiplier-1)*100).toPrecision()}%`,secondary:"Bonus products per cycle"})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(ve,{})}),e.jsx(S,{primary:p,secondary:"Sprays"})]})]})]})},Ye=()=>e.jsxs(Le,{theme:Ae,children:[e.jsx(ke,{}),e.jsx(Xe,{})]});Ce.createRoot(document.getElementById("root")).render(e.jsx(h.StrictMode,{children:e.jsx(Ye,{})}));
//# sourceMappingURL=index-1sNLUKjk.js.map
