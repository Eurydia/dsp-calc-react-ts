import{r as b,j as e}from"./react-c7x3VyAv.js";import{c as Ie}from"./react-dom-nwdlp_2f.js";import{c as Oe,a as Re,T as je,M as ce,I as le,u as Pe,b as ve,S as C,P as N,G as w,B as we,D as ye,d as O,e as A,f as E,R as $,g as ae,h as de,i as ue,j as T,k as S,l as pe,m as _,A as he,L as W,n as j,o as y,F as z,p as f,q as Te,C as Ne,r as D,U as Fe,s as q,t as ke,v as Le,w as Ae,x as Ee,y as $e,z as We}from"./@mui-z14DpNwK.js";import{f as G,F as ze}from"./facility.mts-_VB0zU-w.js";import{r as X,a as H}from"./recipes-ZslLi6jF.js";import{p as Q,P as me,a as xe}from"./proliferator.mts-9Q72QBkP.js";import{s as De}from"./sorter.mts-RHRkJXms.js";/* empty css                    */import"./hoist-non-react-statics-bbVbV8Pa.js";import"./scheduler-jfnXNWZW.js";import"./prop-types-pmxPFTpu.js";import"./react-is-D0-Nh74l.js";import"./@babel-R4VyUtW_.js";import"./@emotion-KQWZ46Z_.js";import"./stylis-UTZzoVRx.js";import"./clsx-Zbgk8kpT.js";import"./react-transition-group-xc2LJcsj.js";import"./@popperjs-v-la0Vhf.js";import"./ingredient.mts-nBNVauyB.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const p of a.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&l(p)}).observe(document,{childList:!0,subtree:!0});function c(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(r){if(r.ep)return;r.ep=!0;const a=c(r);fetch(r.href,a)}})();const Be=Oe({components:{MuiTypography:{styleOverrides:{root:{userSelect:"none"}}}},palette:{mode:"dark",text:{primary:Re("#fff",.87)}}}),Z=o=>{const{sortOptions:n,label:c,value:l,onValueChange:r,options:a,disabledOptions:p}=o,g=b.useMemo(()=>n?a.sort():a,[a,n]),d=b.useMemo(()=>n?p.sort():p,[p,n]);return e.jsxs(je,{select:!0,fullWidth:!0,label:c,value:l,onChange:m=>r(m.target.value),children:[g.filter(m=>!d.includes(m)).map(m=>e.jsx(ce,{value:m,children:m},m)),d.map(m=>e.jsx(ce,{disabled:!0,value:m,children:m},m))]})},B=o=>{const{disabled:n,maxLength:c,prefix:l,suffix:r,label:a,value:p,onChange:g}=o,d=m=>{const i=m.target.value.slice(0,c).normalize();g(i)};return e.jsx(je,{fullWidth:!0,disabled:n,label:a,value:p,onChange:d,InputProps:{startAdornment:e.jsx(le,{position:"start",children:l}),endAdornment:e.jsx(le,{position:"end",children:r})}})},k=(o,n,c)=>{const l=Number.parseInt(o);return Number.isNaN(l)?n:l>c?c:l<n?n:l},L=o=>o.reduce((n,c)=>n+c,0),M=o=>Number.parseFloat(o.toPrecision(9)).toPrecision(),K=(o,n,c)=>{const l=localStorage.getItem(o);if(l===null)return c;try{return n(JSON.parse(l))}catch{return c}},Je=o=>o===12?"Proliferator Mk.I":o===24?"Proliferator Mk.II":o===60?"Proliferator Mk.III":"None",Ue=(o,n,c,l,r,a)=>{const p=Object.fromEntries(Object.entries(l).map(([i,R])=>{let u=Number.parseInt(R);return(Number.isNaN(u)||u===0)&&(u=360),[i,u]})),g=60/o*n,d=Math.min(...Object.entries(r).map(([i,R])=>{const u=R*g;return p[i]/u})),m=Math.min(...Object.entries(a).map(([i,R])=>{const u=R*g*c;return p[i]/u}));return Math.min(d,m)},Ve=(o,n,c,l,r)=>{const a=Object.fromEntries(Object.entries(r).map(([d,m])=>{let i=Number.parseInt(m);return Number.isNaN(i)&&(i=0),[d,i]}));if(Object.values(a).every(d=>d===0))return 0;const p=60/o*n;return Math.max(...Object.entries(l).map(([d,m])=>{const i=m*p*c;return a[d]/i}))},fe=o=>{const n=Object.fromEntries(Object.entries(o).map(([l,r])=>{let a=Number.parseInt(r);return Number.isNaN(a)&&(a=0),[l,a]}));return L(Object.entries(n).map(([l,r])=>De(l).idleConsumptionMW*r))},Ye=(o,n)=>{const c=fe(n);return o+c},_e=(o,n,c)=>{const l=fe(c);return o*n+l},qe=(o,n,c,l,r,a,p)=>{const g=60/o*n,d=Object.fromEntries(Object.entries(l).map(([i,R])=>[i,R*g])),m=Number.parseInt(p);return!Number.isNaN(m)&&m>0&&(d[`${a} (on materials)`]=L(Object.values(l).map(i=>g*i))/m,d[`${a} (on products)`]=L(Object.values(r).map(i=>g*i*c))/m),d},Ge=(o,n,c,l)=>{const r=60/o*n;return Object.fromEntries(Object.entries(l).map(([p,g])=>[p,g*r*c]))},Xe=o=>{const{slotSide:n,children:c,slotMain:l}=o;return e.jsxs(C,{padding:2,spacing:2,children:[e.jsx(N,{sx:{padding:2},children:n}),l,b.Children.toArray(c).map((r,a)=>e.jsx(N,{sx:{padding:2},children:r},`main-col-item-${a}`))]})},He=o=>{const{children:n,slotMain:c,slotSide:l}=o;return e.jsxs(w,{container:!0,children:[e.jsx(w,{item:!0,md:8,children:e.jsx(we,{padding:4,sx:{height:"100vh",overflowY:"auto",scrollbarWidth:"thin"},children:e.jsxs(w,{container:!0,spacing:2,children:[e.jsx(w,{item:!0,md:12,children:c}),[0,1].map(r=>e.jsx(w,{item:!0,md:6,children:e.jsx(C,{spacing:2,children:b.Children.toArray(n).filter((a,p)=>p%2===r).map((a,p)=>e.jsx(N,{square:!0,sx:{padding:2},children:a},`main-col-${r}-item-${p}`))})},`main-col-${r}`))]})})}),e.jsx(w,{item:!0,md:4,children:e.jsx(N,{sx:{height:"100vh",overflowY:"auto",scrollbarWidth:"thin",padding:2},children:l})})]})},Qe=o=>{const{slotSide:n,slotMain:c,children:l}=o,r=Pe();return ve(r.breakpoints.down("sm"))?e.jsx(Xe,{children:l,slotMain:c,slotSide:n}):e.jsx(He,{children:l,slotMain:c,slotSide:n})},Ze=(o,n)=>{const[c,l]=b.useState(()=>{const r=localStorage.getItem(n);if(r===null)return o;try{return JSON.parse(r)}catch{return o}});return b.useEffect(()=>{localStorage.setItem(n,JSON.stringify(c))},[n,c]),{content:c,setContent:l}},ee=(o,n)=>{const[c,l]=b.useState(()=>{const r=localStorage.getItem(n);if(r===null)return o;try{return JSON.parse(r)}catch{return o}});return b.useEffect(()=>{localStorage.setItem(n,JSON.stringify(c))},[c,n]),{content:c,setContent:l}},Ke=()=>{const{content:o,setContent:n}=ee({"Sorter Mk.I":"0","Sorter Mk.II":"0","Sorter Mk.III":"0","Pile Sorter":"0"},"sorters"),{content:c,setContent:l}=ee({},"flowrates"),{content:r,setContent:a}=ee({},"desiredProduction"),{content:p,setContent:g}=Ze("0","sprayCount"),[d,m]=b.useState(()=>K("activeFacility",G,G("Arc Smelter"))),[i,R]=b.useState(()=>K("activeRecipe",X,X("Copper Ingot"))),[u,ge]=b.useState(()=>K("activeProlif",Q,Q("None"))),Se=t=>{const s=G(t);if(m(s),localStorage.setItem("activeFacility",JSON.stringify(s.label)),i.recipeType===s.recipeType)return;let x="Uh oh";const h=Object.values(H).filter(({recipeType:I})=>I===s.recipeType).map(({label:I})=>I);h.length>0&&(x=h[0]),te(x)},te=t=>{const s=X(t);s.speedupOnly&&u.mode===xe.EXTRA_PRODUCTS&&re("None"),R(s),localStorage.setItem("activeRecipe",JSON.stringify(s.label)),a(x=>{const h={};for(const I of Object.keys(s.productRecord))h[I]=x[I]??"0";return h}),l(()=>{const x={};for(const h of Object.keys(s.materialRecord))x[h]="360";for(const h of Object.keys(s.productRecord))x[h]="360";return x})},re=t=>{const s=Q(t);g(s.sprayCount.toString()),ge(s),localStorage.setItem("activeProlif",JSON.stringify(s.label))},ne=(t,s)=>{a(x=>{const h={...x};return s===""?(h[t]="",h):(h[t]=k(s,0,1e7).toString(),h)})},se=(t,s)=>{l(x=>{const h={...x};if(s==="")return h[t]="",h;const I=d.connectionCount*7200,F=L(Object.entries(x).filter(([Y])=>Y!==t).map(([,Y])=>k(Y,360,I)));return h[t]=k(s,0,I-F).toString(),h})},ie=(t,s)=>{n(x=>{const h={...x};if(s==="")return h[t]="",h;const I=L(Object.entries(x).filter(([F])=>F!==t).map(([,F])=>k(F,0,d.connectionCount)));return h[t]=k(s,0,d.connectionCount-I).toString(),h})},oe=Je(u.sprayCount),v=b.useMemo(()=>Ve(i.cycleTimeSecond,d.cycleMultiplier*u.cycleMultiplier,u.productMultiplier,i.productRecord,r),[i.cycleTimeSecond,d.cycleMultiplier,u.cycleMultiplier,u.productMultiplier,i.productRecord,r]),P=b.useMemo(()=>Ue(i.cycleTimeSecond,d.cycleMultiplier*u.cycleMultiplier,u.productMultiplier,c,i.materialRecord,i.productRecord),[i.cycleTimeSecond,d.cycleMultiplier,u.cycleMultiplier,u.productMultiplier,c,i.materialRecord,i.productRecord]),be=b.useMemo(()=>qe(i.cycleTimeSecond,u.cycleMultiplier*d.cycleMultiplier,u.productMultiplier,i.materialRecord,i.productRecord,oe,p),[i.cycleTimeSecond,u.cycleMultiplier,d.cycleMultiplier,u.productMultiplier,i.materialRecord,i.productRecord,oe,p]),Ce=b.useMemo(()=>Ge(i.cycleTimeSecond,u.cycleMultiplier*d.cycleMultiplier,u.productMultiplier,i.productRecord),[i.cycleTimeSecond,u.cycleMultiplier,d.cycleMultiplier,u.productMultiplier,i.productRecord]);let J=0;P>0&&(J=Math.floor(v/P));const Me=v-J*P,U=_e(d.workConsumptionMW,u.workConsumptionMultiplier,o),V=Ye(d.idleConsumptionMW,o);return e.jsxs(Qe,{slotSide:e.jsxs(C,{spacing:4,divider:e.jsx(ye,{flexItem:!0,variant:"fullWidth"}),children:[e.jsxs(C,{spacing:2,children:[e.jsx(O,{children:"Manufacturing"}),e.jsx(Z,{sortOptions:!0,label:"Facility",value:d.label,onValueChange:Se,options:Object.keys(ze),disabledOptions:[]}),e.jsx(Z,{sortOptions:!0,label:"Recipe",value:i.label,onValueChange:te,options:Object.keys(H),disabledOptions:Object.values(H).filter(t=>t.recipeType!==d.recipeType).map(t=>t.label)})]}),e.jsxs(C,{spacing:2,children:[e.jsx(O,{children:"Production target"}),Object.entries(r).map(([t,s])=>e.jsxs(C,{spacing:2,direction:"row",alignItems:"center",justifyContent:"left",children:[e.jsx(B,{label:t,maxLength:8,suffix:"/min",value:s,onChange:x=>ne(t,x)}),e.jsx(A,{disabled:s==="0",onClick:()=>ne(t,"0"),children:e.jsx(E,{title:"Reset",children:e.jsx($,{})})})]},t))]}),e.jsxs(C,{spacing:2,children:[e.jsx(O,{children:"Proliferation"}),e.jsx(Z,{label:"Proliferator",value:u.label,onValueChange:re,options:Object.keys(me),disabledOptions:Object.values(me).filter(t=>i.speedupOnly&&t.mode===xe.EXTRA_PRODUCTS).map(t=>t.label)}),e.jsxs(C,{spacing:2,direction:"row",alignItems:"center",justifyContent:"left",children:[e.jsx(B,{disabled:u.sprayCount<=0,maxLength:9,suffix:"sprays",label:"Uses",value:p,onChange:g}),e.jsx(A,{disabled:u.sprayCount<=0||u.sprayCount.toString()===p,onClick:()=>g(u.sprayCount.toString()),children:e.jsx(E,{title:"Reset",children:e.jsx($,{})})})]})]}),e.jsxs(C,{spacing:2,children:[e.jsx(O,{children:"Transport capacity"}),Object.entries(c).map(([t,s])=>e.jsxs(C,{spacing:2,direction:"row",alignItems:"center",justifyContent:"left",children:[e.jsx(B,{label:t,maxLength:8,suffix:"/min",value:s,onChange:x=>se(t,x)}),e.jsx(A,{disabled:s==="360",onClick:()=>se(t,"360"),children:e.jsx(E,{title:"Reset",children:e.jsx($,{})})})]},t))]}),e.jsxs(C,{spacing:2,children:[e.jsx(O,{children:"Sorter connections"}),Object.entries(o).map(([t,s])=>e.jsxs(C,{spacing:2,direction:"row",alignItems:"center",justifyContent:"left",children:[e.jsx(B,{label:t,maxLength:6,suffix:`/${d.connectionCount}`,value:s,onChange:x=>ie(t,x)}),e.jsx(A,{disabled:s==="0",onClick:()=>ie(t,"0"),children:e.jsx(E,{title:"Reset",children:e.jsx($,{})})})]},t))]})]}),slotMain:e.jsxs(C,{spacing:2,children:[e.jsx(N,{square:!0,sx:{padding:2},children:e.jsx(ae,{children:e.jsxs(de,{children:[e.jsx(ue,{children:e.jsxs(T,{children:[e.jsx(S,{colSpan:3,children:"Item (per minute)"}),e.jsx(S,{colSpan:1,align:"right",children:"Total"}),e.jsx(S,{colSpan:1,align:"right",children:"Per Array"}),e.jsx(S,{colSpan:1,align:"right",children:"Per Facility"})]})}),e.jsxs(pe,{children:[Object.entries(be).map(([t,s])=>e.jsxs(T,{children:[e.jsx(S,{colSpan:3,children:t}),[s*v,s*P,s].map((x,h)=>e.jsx(S,{colSpan:1,children:e.jsxs(O,{display:"flex",alignItems:"center",justifyContent:"flex-end",fontSize:"inherit",children:[e.jsx(_,{fontSize:"inherit"}),M(x)]})},`demand-${h}`))]},t)),Object.entries(Ce).map(([t,s])=>e.jsxs(T,{children:[e.jsx(S,{colSpan:3,children:t}),[s*v,s*P,s].map((x,h)=>e.jsx(S,{colSpan:1,children:e.jsxs(O,{display:"flex",alignItems:"center",justifyContent:"flex-end",fontSize:"inherit",children:[e.jsx(he,{fontSize:"inherit"}),M(x)]})},`supply-${h}`))]},t))]})]})})}),e.jsx(N,{square:!0,sx:{padding:2},children:e.jsx(ae,{children:e.jsxs(de,{children:[e.jsx(ue,{children:e.jsxs(T,{children:[e.jsx(S,{colSpan:3,children:"Power consumption (MW)"}),e.jsx(S,{colSpan:1,align:"right",children:"Total"}),e.jsx(S,{colSpan:1,align:"right",children:"Per array"}),e.jsx(S,{colSpan:1,align:"right",children:"Per facility"})]})}),e.jsxs(pe,{children:[e.jsxs(T,{children:[e.jsx(S,{colSpan:3,children:"Work"}),[U*v,U*P,U].map((t,s)=>e.jsx(S,{colSpan:1,children:e.jsxs(O,{display:"flex",alignItems:"center",justifyContent:"flex-end",fontSize:"inherit",children:[e.jsx(_,{fontSize:"inherit"}),M(t)]})},`supply-${s}`))]}),e.jsxs(T,{children:[e.jsx(S,{colSpan:3,children:"Idle"}),[V*v,V*P,V].map((t,s)=>e.jsx(S,{colSpan:1,children:e.jsxs(O,{display:"flex",alignItems:"center",justifyContent:"flex-end",fontSize:"inherit",children:[e.jsx(_,{fontSize:"inherit"}),M(t)]})},`supply-${s}`))]})]})]})})})]}),children:[e.jsxs(W,{subheader:"Layout",dense:!0,children:[e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(z,{})}),e.jsx(f,{primary:P,secondary:"Facilities per array"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(z,{})}),e.jsx(f,{primary:J,secondary:"Arrays"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(z,{})}),e.jsx(f,{primary:v,secondary:"Total facilities"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(z,{})}),e.jsx(f,{primary:Me,secondary:"Leftover facilities"})]})]}),e.jsxs(W,{subheader:"Facility information",dense:!0,children:[e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(Te,{})}),e.jsx(f,{primary:d.label,secondary:"Name"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(Ne,{})}),e.jsx(f,{primary:d.recipeType,secondary:"Category"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(D,{})}),e.jsx(f,{primary:`${M(d.cycleMultiplier*100)}%`,secondary:"Cycle speed"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(Fe,{})}),e.jsx(f,{primary:d.connectionCount,secondary:"Sorter connections"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(q,{})}),e.jsx(f,{primary:`${M(d.workConsumptionMW)} MW`,secondary:"Work comsumption"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(q,{})}),e.jsx(f,{primary:`${M(d.idleConsumptionMW)} MW`,secondary:"Idle comsumption"})]})]}),e.jsxs(W,{subheader:"Recipe infomation",dense:!0,children:[e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(D,{})}),e.jsx(f,{primary:`${M(i.cycleTimeSecond)} s`,secondary:"Cycle time"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(ke,{})}),e.jsx(f,{primary:i.speedupOnly?"No":"Yes",secondary:"Extra products bonus"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(Le,{})}),e.jsx(f,{primary:Object.entries(i.materialRecord).map(([t,s])=>e.jsx(O,{fontSize:"inherit",children:`${s} ${t}`},t)),secondary:"Materials"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(he,{})}),e.jsx(f,{primary:Object.entries(i.productRecord).map(([t,s])=>e.jsx(O,{fontSize:"inherit",children:`${s} ${t}`},t)),secondary:"Products"})]})]}),e.jsxs(W,{dense:!0,subheader:"Proliferator effects",children:[e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(D,{})}),e.jsx(f,{primary:`${M((u.cycleMultiplier-1)*100)}%`,secondary:"Bonus cycle speed"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(D,{})}),e.jsx(f,{primary:`${M((u.productMultiplier-1)*100)}%`,secondary:"Bonus products per cycle"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(q,{})}),e.jsx(f,{primary:`${M((u.workConsumptionMultiplier-1)*100)}%`,secondary:"Additional work consumption"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(Ae,{})}),e.jsx(f,{primary:M(p===""?0:Number.parseInt(p)),secondary:"Sprays"})]})]})]})},et=()=>e.jsxs(Ee,{maxWidth:"md",component:"main",children:[e.jsx("section",{children:e.jsx("h1",{children:"About this project"})}),e.jsxs("section",{children:[e.jsx("h2",{children:"Motivation"}),e.jsx("p",{children:"To discuss the motivation, let me tell you about my personal experiences with Dyson Sphere Program. I played DSP a lot during the Covid pandemic. When I look back, I might have enjoyed it a little too much. I noticed that, after each long session, my fingers were sore from clicking the hundreds of sorters."}),e.jsx("p",{children:'One day, I decided to sit down, and thought about the possible reasons why my fingers were sore. It was because I was clicking so much. Then, I understood. I was playing "inefficiently" which led to excessively clicking.'}),e.jsx("p",{children:"When I build a new array of smelts, I would place down roughly fifty arc smelters, then monitor which one did not receive input, and remove the excess from the array. It was rather primitive."}),e.jsx("p",{children:"Later that night, the idea of this calculator came to me in a dream. What if I can determine the optimal number of arc smelters beforehand, then I would not waste extra clicks, and potentially give myself carpal tunnel by the age of thrity."})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"Scopes"}),e.jsx("p",{children:"At the time, Factorio Lab was one of the few calulator available for DSP, and it was missing features I need to save my fingers. So I had to take initiative and build one myself."}),e.jsx("p",{children:"Consider a basic iron ingot setup. One line of tier three belt supplies iron ore, and another takes iron ingot away. Let's say the iron ores are proliferated, and the plane smelter bonus is set to speed bonus. In this scenario, it can be calculated that five is the optimal number of plane smelters. More than five, the supply could not keep up results in idling, and any less, wasteful."}),e.jsx("p",{children:"This is the core problem this calculator addresses. How do make this calculation for other scenarios."})]})]}),tt=()=>e.jsxs($e,{theme:Be,children:[e.jsx(We,{}),e.jsxs(C,{divider:e.jsx(ye,{flexItem:!0}),children:[e.jsx(Ke,{}),e.jsx(et,{})]})]});Ie.createRoot(document.getElementById("root")).render(e.jsx(b.StrictMode,{children:e.jsx(tt,{})}));
//# sourceMappingURL=index-BF826OiD.js.map
